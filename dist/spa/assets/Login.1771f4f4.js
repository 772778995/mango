import{u as y,d as v,l as E,e as x,f as F,o as S,c as k,a as u,w as c,Q as _,g as e,h as s,i as C,j as b,t as B,k as w}from"./index.4a8c98c0.js";import{u as I,a as L,i as V,Q as $}from"./useSendEmail.c37dda1d.js";var A=g=>{const{emailInputRef:d}=g,t=y(),i=v({email:"6666@5i996.icu",captcha:"666666"}),{leftSeconds:r,sendEmailCode:n,isSendEmailCodeLoading:m}=I(),p=async()=>{!await d.value.validate()||n({captchaType:"login",email:i.value.email})},[a,o]=L(()=>x.post("/api/user/login-email-captcha",i.value));return{leftSeconds:r,sendEmailCodeHandler:p,isSendEmailCodeLoading:m,loginForm:i,isLoginLoading:o,loginHandler:async()=>{const{token:f,userInfo:h}=await a();localStorage.setItem("token",f),await E.setItem("userInfo",h),t.replace({name:"\u9996\u9875"})}}};const H={_flex:"~"},Q={_flex:"~"},R={_flex:"1"},D={_m:"l-10px"},z={_m:"l-10px"},N={_flex:"~"},j=F({__name:"Login",setup(g){const d=v(),{leftSeconds:t,isSendEmailCodeLoading:i,sendEmailCodeHandler:r,loginForm:n,isLoginLoading:m,loginHandler:p}=A({emailInputRef:d});return(a,o)=>(S(),k("div",H,[u(w,{_m:"auto",_w:"80vw max-350px",_space:"y-10px",onSubmit:e(p)},{default:c(()=>[u(_,{modelValue:e(n).email,"onUpdate:modelValue":o[0]||(o[0]=l=>e(n).email=l),ref_key:"emailInputRef",ref:d,label:a.$t("\u90AE\u7BB1\u5730\u5740"),maxlength:"255",outlined:"","lazy-rules":"",rules:[l=>e(V)(l)||a.$t("\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740")]},null,8,["modelValue","label","rules"]),s("div",Q,[s("div",R,[u(_,{modelValue:e(n).captcha,"onUpdate:modelValue":o[1]||(o[1]=l=>e(n).captcha=l),label:a.$t("\u9A8C\u8BC1\u7801"),outlined:"",maxlength:"6","lazy-rules":"",rules:[l=>/\d{6}/.test(l)||a.$t("\u8BF7\u8F93\u51656\u4F4D\u6570\u5B57\u7684\u9A8C\u8BC1\u7801")]},null,8,["modelValue","label","rules"])]),u(C,{_w:"170px",_m:"l-20px",_h:"56px",color:"primary",icon:"email",loading:e(t)>0||e(i),onClick:e(r)},b({default:c(()=>[s("div",D,B(a.$t("\u53D1\u9001\u90AE\u7BB1\u9A8C\u8BC1\u7801")),1)]),_:2},[e(t)>0?{name:"loading",fn:c(()=>[u($),s("div",z,B(e(t)),1)]),key:"0"}:void 0]),1032,["loading","onClick"])]),u(C,{loading:e(m),label:a.$t("\u767B\u5F55"),icon:"person",color:"primary",_m:"!y-20px",_w:"full",_h:"54px",type:"submit"},null,8,["loading","label"]),s("div",N,[s("a",{_m:"l-auto",onClick:o[2]||(o[2]=l=>a.$router.push({name:"\u6CE8\u518C"}))},"\u6CE8\u518C\u8D26\u53F7")])]),_:1},8,["onSubmit"])]))}});export{j as default};
